


<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      <link rel="shortcut icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.1.2, mkdocs-material-5.5.12">
    
    
      
        <title>Resolve Failed Recipes - Baker</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.4dd2dd8d.min.css">
      
      
    
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto",-apple-system,BlinkMacSystemFont,Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono",SFMono-Regular,Consolas,Menlo,monospace}</style>
      
    
    
    
      <link rel="stylesheet" href="../../../css/ing.css">
    
    
      
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#resolve-failed-recipes" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid" aria-label="Header">
    <a href="../../.." title="Baker" class="md-header-nav__button md-logo" aria-label="Baker">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 003-3 3 3 0 00-3-3 3 3 0 00-3 3 3 3 0 003 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header-nav__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header-nav__title" data-md-component="header-title">
      
        <div class="md-header-nav__ellipsis">
          <span class="md-header-nav__topic md-ellipsis">
            Baker
          </span>
          <span class="md-header-nav__topic md-ellipsis">
            
              Resolve Failed Recipes
            
          </span>
        </div>
      
    </div>
    
      <label class="md-header-nav__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active">
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" data-md-component="search-reset" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header-nav__source">
        
<a href="https://github.com/ing-bank/baker/" title="Go to repository" class="md-source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 00-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 01-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 000 40.81l195.61 195.6a28.86 28.86 0 0040.8 0l194.69-194.69a28.86 28.86 0 000-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    ing-bank/baker
  </div>
</a>
      </div>
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
        
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="Baker" class="md-nav__button md-logo" aria-label="Baker">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 003-3 3 3 0 00-3-3 3 3 0 00-3 3 3 3 0 003 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    Baker
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/ing-bank/baker/" title="Go to repository" class="md-source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 00-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 01-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 000 40.81l195.61 195.6a28.86 28.86 0 0040.8 0l194.69-194.69a28.86 28.86 0 000-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    ing-bank/baker
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../../.." title="Home" class="md-nav__link">
      Home
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../getting-started/" title="Getting Started" class="md-nav__link">
      Getting Started
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../concepts/" title="Concepts" class="md-nav__link">
      Concepts
    </a>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4" checked>
    
    <label class="md-nav__link" for="nav-4">
      Development Life Cycle
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Development Life Cycle" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        <span class="md-nav__icon md-icon"></span>
        Development Life Cycle
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../design-a-recipe/" title="Design a Recipe" class="md-nav__link">
      Design a Recipe
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../use-visualizations/" title="Use Visualizations" class="md-nav__link">
      Use Visualizations
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../implement-interactions/" title="Implement Interactions" class="md-nav__link">
      Implement Interactions
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../bake-fire-events-and-inquiry/" title="Bake, Fire Events and Inquiry" class="md-nav__link">
      Bake, Fire Events and Inquiry
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../test/" title="Test" class="md-nav__link">
      Test
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../configure/" title="Configure" class="md-nav__link">
      Configure
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../monitor/" title="Monitor" class="md-nav__link">
      Monitor
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Resolve Failed Recipes
        <span class="md-nav__icon md-icon"></span>
      </label>
    
    <a href="./" title="Resolve Failed Recipes" class="md-nav__link md-nav__link--active">
      Resolve Failed Recipes
    </a>
    
      
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#interaction-failure-strategy" class="md-nav__link">
    Interaction Failure strategy
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#block-interaction" class="md-nav__link">
    Block interaction
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#fire-event" class="md-nav__link">
    Fire event
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#retry-with-incremental-back-off" class="md-nav__link">
    Retry with incremental back-off
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#default-failure-strategy" class="md-nav__link">
    Default failure strategy
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#bakerretryinteractionrecipeinstanceid-interactionname" class="md-nav__link">
    baker.retryInteraction(recipeInstanceId, interactionName)
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#bakerresolveinteractionrecipeinstanceid-interactionname-event" class="md-nav__link">
    baker.resolveInteraction(recipeInstanceId, interactionName, event)
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#bakerstopretryinginteractionrecipeinstanceid-interactionname" class="md-nav__link">
    baker.stopRetryingInteraction(recipeInstanceId, interactionName)
  </a>
  
</li>
      
    </ul>
  
</nav>
    
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5">
    
    <label class="md-nav__link" for="nav-5">
      Reference
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Reference" data-md-level="1">
      <label class="md-nav__title" for="nav-5">
        <span class="md-nav__icon md-icon"></span>
        Reference
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../reference/main-abstractions/" title="Main Abstractions" class="md-nav__link">
      Main Abstractions
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../reference/execution-semantics/" title="Execution Semantics" class="md-nav__link">
      Execution Semantics
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../reference/baker-types-and-values/" title="Baker Types and Values" class="md-nav__link">
      Baker Types and Values
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../reference/dsls/" title="Recipe DSLs" class="md-nav__link">
      Recipe DSLs
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../reference/runtime/" title="The Akka Based Runtime" class="md-nav__link">
      The Akka Based Runtime
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../reference/visualization/" title="Visualization" class="md-nav__link">
      Visualization
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../reference/event-listener/" title="Event Listener" class="md-nav__link">
      Event Listener
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../reference/stores/" title="Event Stores and Cluster Configuration" class="md-nav__link">
      Event Stores and Cluster Configuration
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-6" type="checkbox" id="nav-6">
    
    <label class="md-nav__link" for="nav-6">
      Versions
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Versions" data-md-level="1">
      <label class="md-nav__title" for="nav-6">
        <span class="md-nav__icon md-icon"></span>
        Versions
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../versions/baker-3-release-notes/" title="Release Notes v3" class="md-nav__link">
      Release Notes v3
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../versions/baker-3/" title="Migration Guide v3" class="md-nav__link">
      Migration Guide v3
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../versions/baker-2/" title="Migration Guide v2" class="md-nav__link">
      Migration Guide v2
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../feature-comparison/" title="Feature comparison" class="md-nav__link">
      Feature comparison
    </a>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#interaction-failure-strategy" class="md-nav__link">
    Interaction Failure strategy
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#block-interaction" class="md-nav__link">
    Block interaction
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#fire-event" class="md-nav__link">
    Fire event
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#retry-with-incremental-back-off" class="md-nav__link">
    Retry with incremental back-off
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#default-failure-strategy" class="md-nav__link">
    Default failure strategy
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#bakerretryinteractionrecipeinstanceid-interactionname" class="md-nav__link">
    baker.retryInteraction(recipeInstanceId, interactionName)
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#bakerresolveinteractionrecipeinstanceid-interactionname-event" class="md-nav__link">
    baker.resolveInteraction(recipeInstanceId, interactionName, event)
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#bakerstopretryinginteractionrecipeinstanceid-interactionname" class="md-nav__link">
    baker.stopRetryingInteraction(recipeInstanceId, interactionName)
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/ing-bank/baker/edit/master/docs/sections/development-life-cycle/resolve-failed-recipe-instances.md" title="Edit this page" class="md-content__button md-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
                  </a>
                
                
                  
                
                
                <h1 id="resolve-failed-recipes">Resolve Failed Recipes</h1>
<h2 id="interaction-failure-strategy">Interaction Failure strategy</h2>
<p>When an interaction throws an exception there are a number of mitigation strategies:</p>
<h2 id="block-interaction">Block interaction</h2>
<p>This is the <em>DEFAULT</em> strategy if no <a href="#default-failure-strategy">default strategy</a> is defined.</p>
<p>This option is suitable for non idempotent interactions that cannot be retried.</p>
<p>When an exception is thrown from the interaction the interaction is <em>blocked</em>.</p>
<p>This means that the interaction cannot execute again automatically.</p>
<h2 id="fire-event">Fire event</h2>
<p>This option is analagous to a <code>try { } catch { }</code> in code. When an exception is raised from the interaction you specify an
event to fire. So instead of failing the process continues.</p>
<p>Example:</p>
<div class="highlight"><pre><span></span><code>  <span class="p">.</span><span class="na">withInteractions</span><span class="p">(</span>
    <span class="n">of</span><span class="p">(</span><span class="n">ValidateOrder</span><span class="p">.</span><span class="na">class</span><span class="p">)</span>
    <span class="p">.</span><span class="na">withInteractionFailureStrategy</span><span class="p">(</span>
       <span class="n">InteractionFailureStrategy</span><span class="p">.</span><span class="na">FireEvent</span><span class="p">(</span><span class="s">&quot;ValidateOrderFailed&quot;</span><span class="p">)</span>
     <span class="p">)</span>
   <span class="p">)</span>
</code></pre></div>

<h2 id="retry-with-incremental-back-off">Retry with incremental back-off</h2>
<p>Incremental back-off allows you to configure a retry mechanism that takes longer for each retry.
The idea here is that you quickly retry at first but slower over time. To not overload your system but give it time to recover.</p>
<div class="highlight"><pre><span></span><code>  <span class="p">.</span><span class="na">withInteractions</span><span class="p">(</span>
    <span class="n">of</span><span class="p">(</span><span class="n">ValidateOrder</span><span class="p">.</span><span class="na">class</span><span class="p">)</span>
      <span class="p">.</span><span class="na">withDefaultFailureStrategy</span><span class="p">(</span><span class="k">new</span> <span class="n">RetryWithIncrementalBackoffBuilder</span><span class="p">()</span>
        <span class="p">.</span><span class="na">withInitialDelay</span><span class="p">(</span><span class="n">Duration</span><span class="p">.</span><span class="na">ofMillis</span><span class="p">(</span><span class="mi">100</span><span class="p">))</span>
        <span class="p">.</span><span class="na">withBackoffFactor</span><span class="p">(</span><span class="mf">2.0</span><span class="p">)</span>
        <span class="p">.</span><span class="na">withMaxTimeBetweenRetries</span><span class="p">(</span><span class="n">Duration</span><span class="p">.</span><span class="na">ofSeconds</span><span class="p">(</span><span class="mi">100</span><span class="p">))</span>
        <span class="p">.</span><span class="na">withDeadline</span><span class="p">(</span><span class="n">Duration</span><span class="p">.</span><span class="na">ofHours</span><span class="p">(</span><span class="mi">24</span><span class="p">))</span>
        <span class="p">.</span><span class="na">build</span><span class="p">())</span>
  <span class="p">)</span>
</code></pre></div>

<p>What do these parameters mean?</p>
<table>
<thead>
<tr>
<th>name</th>
<th>meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>initialDelay</code></td>
<td>The delay for the first retry.</td>
</tr>
<tr>
<td><code>backoffFactor</code></td>
<td>The back-off factor for the delay (optional, <code>default = 2</code>)</td>
</tr>
<tr>
<td><code>maxTimeBetweenRetries</code></td>
<td>The maximum interval between retries.</td>
</tr>
<tr>
<td><code>deadLine</code></td>
<td>The maximum total amount of time spend delaying.</td>
</tr>
</tbody>
</table>
<p>For our example this results in the following delay pattern:</p>
<p><code>100 millis</code> -&gt; <code>200 millis</code> -&gt; <code>400 millis</code> -&gt; <code>...</code> -&gt;  <code>100 seconds</code> -&gt; <code>100 seconds</code></p>
<p>Which can be visualized like this:</p>
<p><img alt="" src="/images/incremental-backoff.png" /></p>
<p>Note that these delays do <strong>not</strong> include interaction execution time.</p>
<p>For example, if the first retry execution takes <code>5</code> seconds (and fails again) then the second retry will
be triggered after (from the start):</p>
<p><code>(100 millis + 5 seconds + 200 millis) = 5.3 seconds</code></p>
<p>This also means that the <code>24 hour</code> deadline <strong>does not</strong> include interaction execution time. It is advisable to take this
into account when coming up with this number.</p>
<p><strong>Retry exhaustion</strong></p>
<p>It can happen that after some time, when an interaction keeps failing, that the retry is exhausted.</p>
<p>When this happens 2 things may happen.</p>
<p>Either the interaction becomes [blocked(#blocked-interaction).</p>
<p>Or if you configure so, the process continues with a predefined event:</p>
<div class="highlight"><pre><span></span><code><span class="p">.</span><span class="na">withDefaultFailureStrategy</span><span class="p">(</span><span class="k">new</span> <span class="n">RetryWithIncrementalBackoffBuilder</span><span class="p">()</span>
  <span class="p">.</span><span class="na">withFireRetryExhaustedEvent</span><span class="p">(</span><span class="n">SomeEvent</span><span class="p">.</span><span class="na">class</span><span class="p">))</span>
</code></pre></div>

<p>Note that this event class <strong>requires</strong> an empty constructor to be present and <strong>cannot</strong> provide ingredients.</p>
<h2 id="default-failure-strategy">Default failure strategy</h2>
<p>You can also define a default failure strategy on the recipe level.</p>
<p>This then serves as a fallback if none is defined for an interaction.</p>
<p>For example:</p>
<div class="highlight"><pre><span></span><code><span class="kd">final</span> <span class="n">Recipe</span> <span class="n">webshopRecipe</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Recipe</span><span class="p">(</span><span class="s">&quot;webshop&quot;</span><span class="p">)</span>
    <span class="p">.</span><span class="na">withDefaultFailureStrategy</span><span class="p">(</span>
        <span class="k">new</span> <span class="n">RetryWithIncrementalBackoffBuilder</span><span class="p">()</span>
            <span class="p">.</span><span class="na">withInitialDelay</span><span class="p">(</span><span class="n">Duration</span><span class="p">.</span><span class="na">ofMillis</span><span class="p">(</span><span class="mi">100</span><span class="p">))</span>
            <span class="p">.</span><span class="na">withDeadline</span><span class="p">(</span><span class="n">Duration</span><span class="p">.</span><span class="na">ofHours</span><span class="p">(</span><span class="mi">24</span><span class="p">))</span>
            <span class="p">.</span><span class="na">withMaxTimeBetweenRetries</span><span class="p">(</span><span class="n">Duration</span><span class="p">.</span><span class="na">ofMinutes</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
            <span class="p">.</span><span class="na">build</span><span class="p">());</span>
</code></pre></div>

<h2 id="bakerretryinteractionrecipeinstanceid-interactionname">baker.retryInteraction(recipeInstanceId, interactionName)</h2>
<p>It is possible that during the execution of a <code>RecipeInstance</code> it becomes <em>blocked</em>, this can happen either because it 
is <code>directly blocked</code> by an exception (and the <code>FailureStrategy</code> of the <code>Interaction</code> of the <code>Recipe</code> was set to block) 
or that the retry strategy was exhausted. At this point it is possible to resolve the blocked interaction in 2 ways. 
This one involves forcing another try, resulting either on a successful continued process, or again on a failed state, 
to check this you will need to request the state of the <code>RecipeInstance</code> again.</p>
<p><em>Note: this behaviour can be automatically preconfigured by using the <code>RetryWithIncrementalBackoff</code> <code>FailureStrategy</code>
on the <code>Interaction</code> of the <code>Recipe</code></em></p>
<div class="tabbed-set" data-tabs="1:2"><input checked="checked" id="__tabbed_1_1" name="__tabbed_1" type="radio" /><label for="__tabbed_1_1">Scala</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">program</span><span class="k">:</span> <span class="kt">Future</span><span class="o">[</span><span class="kt">Unit</span><span class="o">]</span> <span class="k">=</span> 
    <span class="n">baker</span><span class="o">.</span><span class="n">retryInteraction</span><span class="o">(</span><span class="n">recipeInstanceId</span><span class="o">,</span> <span class="s">&quot;ReserveItems&quot;</span><span class="o">)</span>
</code></pre></div>

</div>
<input id="__tabbed_1_2" name="__tabbed_1" type="radio" /><label for="__tabbed_1_2">Java</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="n">CompletableFuture</span><span class="o">&lt;</span><span class="n">BoxedUnit</span><span class="o">&gt;</span> <span class="n">program</span> <span class="o">=</span> 
    <span class="n">baker</span><span class="p">.</span><span class="na">retryInteraction</span><span class="p">(</span><span class="n">recipeInstanceId</span><span class="p">,</span> <span class="s">&quot;ReserveItems&quot;</span><span class="p">);</span>
</code></pre></div>

</div>
</div>
<h2 id="bakerresolveinteractionrecipeinstanceid-interactionname-event">baker.resolveInteraction(recipeInstanceId, interactionName, event)</h2>
<p>It is possible that during the execution of a <code>RecipeInstance</code> it becomes <em>blocked</em>, this can happen either because it 
is <code>directly blocked</code> by an exception or that the retry strategy was exhausted. At this point it is possible to resolve 
the blocked interaction in 2 ways. This one involves resolving the interaction with a chosen <code>EventInstance</code> to replace
the one that would have had been computed by the <code>InteractionInstance</code>.</p>
<p><em>Note: this behaviour can be automatically preconfigured by using the <code>FireEventAfterFailure(eventName)</code> <code>FailureStrategy</code>
on the <code>Interaction</code> of the <code>Recipe</code></em></p>
<div class="tabbed-set" data-tabs="2:2"><input checked="checked" id="__tabbed_2_1" name="__tabbed_2" type="radio" /><label for="__tabbed_2_1">Scala</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">program</span><span class="k">:</span> <span class="kt">Future</span><span class="o">[</span><span class="kt">Unit</span><span class="o">]</span> <span class="k">=</span> 
    <span class="n">baker</span><span class="o">.</span><span class="n">resolveInteraction</span><span class="o">(</span><span class="n">recipeInstanceId</span><span class="o">,</span> <span class="s">&quot;ReserveItems&quot;</span><span class="o">,</span> <span class="nc">ItemsReserved</span><span class="o">(</span><span class="nc">List</span><span class="o">(</span><span class="s">&quot;item1&quot;</span><span class="o">)))</span>
</code></pre></div>

</div>
<input id="__tabbed_2_2" name="__tabbed_2" type="radio" /><label for="__tabbed_2_2">Java</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="n">CompletableFuture</span><span class="o">&lt;</span><span class="n">BoxedUnit</span><span class="o">&gt;</span> <span class="n">program</span> <span class="o">=</span> 
    <span class="n">baker</span><span class="p">.</span><span class="na">resolveInteraction</span><span class="p">(</span><span class="n">recipeInstanceId</span><span class="p">,</span> <span class="s">&quot;ReserveItems&quot;</span><span class="p">,</span> <span class="k">new</span> <span class="n">ItemsReserved</span><span class="p">(</span><span class="n">List</span><span class="p">(</span><span class="s">&quot;item1&quot;</span><span class="p">)));</span>
</code></pre></div>

</div>
</div>
<h2 id="bakerstopretryinginteractionrecipeinstanceid-interactionname">baker.stopRetryingInteraction(recipeInstanceId, interactionName)</h2>
<p>If an <code>Interaction</code> is configured with a <code>RetryWithIncrementalBackoff</code> <code>FailureStrategy</code> then it will not stop retrying 
until you call this API or a successful outcome happens from the <code>InteractionInstance</code>.</p>
<div class="tabbed-set" data-tabs="3:2"><input checked="checked" id="__tabbed_3_1" name="__tabbed_3" type="radio" /><label for="__tabbed_3_1">Scala</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="k">val</span> <span class="n">program</span><span class="k">:</span> <span class="kt">Future</span><span class="o">[</span><span class="kt">Unit</span><span class="o">]</span> <span class="k">=</span> 
    <span class="n">baker</span><span class="o">.</span><span class="n">stopRetryingInteraction</span><span class="o">(</span><span class="n">recipeInstanceId</span><span class="o">,</span> <span class="s">&quot;ReserveItems&quot;</span><span class="o">)</span>
</code></pre></div>

</div>
<input id="__tabbed_3_2" name="__tabbed_3" type="radio" /><label for="__tabbed_3_2">Java</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="n">CompletableFuture</span><span class="o">&lt;</span><span class="n">BoxedUnit</span><span class="o">&gt;</span> <span class="n">program</span> <span class="o">=</span> 
    <span class="n">baker</span><span class="p">.</span><span class="na">stopRetryingInteraction</span><span class="p">(</span><span class="n">recipeInstanceId</span><span class="p">,</span> <span class="s">&quot;ReserveItems&quot;</span><span class="p">);</span>
</code></pre></div>

</div>
</div>
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid" aria-label="Footer">
        
          <a href="../monitor/" title="Monitor" class="md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
            </div>
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Monitor
              </div>
            </div>
          </a>
        
        
          <a href="../../reference/main-abstractions/" title="Main Abstractions" class="md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Main Abstractions
              </div>
            </div>
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../../assets/javascripts/vendor.3636a4ec.min.js"></script>
      <script src="../../../assets/javascripts/bundle.e9fe3281.min.js"></script><script id="__lang" type="application/json">{"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents"}</script>
      
      <script>
        app = initialize({
          base: "../../..",
          features: [],
          search: Object.assign({
            worker: "../../../assets/javascripts/worker/search.5eca75d3.min.js"
          }, typeof search !== "undefined" && search)
        })
      </script>
      
    
  </body>
</html>